function sendFile(n,e,a){var o=new XMLHttpRequest,t=new FormData;o.upload.onprogress=function(n){var e=Math.floor(n.loaded/n.total*90);$(".position-load").fadeIn(),$(".position-load").width(e+"%")},o.open("POST",e,!0),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var n=JSON.parse(o.responseText);1==n[0]&&("imgs"==a?$("#img").val($("#img").val()+n[1]+";"):"memes"==a?$("#img").val($("#img").val()+n[1]):($(".owner-load").fadeOut(),$(".owner-drag").fadeIn(),$("#target").attr("src",n[1]),targetStart(a)))}},t.append("response",n),o.send(t)}function targetStart(n){function e(n){a=n.x,$("#x1").val(n.x),o=n.y,$("#y1").val(n.y),t=n.x2,$("#x2").val(n.x2),s=n.y2,$("#y2").val(n.y2),$("#w").val(n.w),$("#h").val(n.h),n.w>0&&n.h>0?$("#crop").fadeIn():$("#crop").fadeOut()}var a,o,t,s,i,r="image/cat/",d=$("#target").height();$("#target").width();"video"==n&&(r="image/video/"),$("#target").Jcrop({onChange:e,onSelect:e,bgColor:"black",bgOpacity:.4,setSelect:[d,d,0,0],minSize:[90,90],aspectRatio:1},function(){i=this}),$("#release").click(function(n){i.release()}),$(document).on("click","#crop",function(e){var i=$("#target").attr("src");i="http://dirty.com"+i;var d=$("#target").height(),l=$("#target").width();$.post("/ajax/resize",{x1:a,x2:t,y1:o,y2:s,img:i,crop:r,he:d,wi:l,type:n},function(n){$(".win__fixed").fadeOut(),$(".win__fixed").remove(),$("body").css({overflow:"auto"}),$("#url").val(n)})})}function valid(n,e,a,o,t){if(0==$(n).val().length)warning++,$(n).after("<div class='warning'>Вы не заполнили поле</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else if($(n).val().length<e)warning++,$(n).after("<div class='warning'>Не менее "+e+" символов</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else if($(n).val().length>a)warning++,$(n).after("<div class='warning'>Не более "+a+" символов</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else{if(void 0===o)return $(n).css({border:"1px solid rgb(236, 232, 232)"}),$(n).val();if(o.test($(n).val()))return $(n).css({border:"1px solid rgb(236, 232, 232)"}),$(n).val();warning++,$(n).after("<div class='warning'>"+t+"</div>"),$(n).css({borderBottom:"2px solid #9c27b0"})}}function valid(n,e,a,o,t){if(0==$(n).val().length)warning++,$(n).after("<div class='warning'>Вы не заполнили поле</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else if($(n).val().length<e)warning++,$(n).after("<div class='warning'>Не менее "+e+" символов</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else if($(n).val().length>a)warning++,$(n).after("<div class='warning'>Не более "+a+" символов</div>"),$(n).css({borderBottom:"2px solid #9c27b0"});else{if(void 0===o)return $(n).css({border:"1px solid rgb(236, 232, 232)"}),$(n).val();if(o.test($(n).val()))return $(n).css({border:"1px solid rgb(236, 232, 232)"}),$(n).val();warning++,$(n).after("<div class='warning'>"+t+"</div>"),$(n).css({borderBottom:"2px solid #9c27b0"})}}autosize(document.getElementsByClassName("autosizes")),$(".porn-nav-item").hover(function(){$(this).find(".porn-header__submenu-sub").stop(!0,!0).slideDown(500)},function(){$(this).find(".porn-header__submenu-sub").stop(!0,!1).slideUp(500)}),$(document).ready(function(){$(".lightgallery").lightGallery({share:!1}),$("#lightgallery").lightGallery({share:!1}),$("#top").click(function(){return $("html, body").animate({scrollTop:0},500),!1})}),$(document).on("click","#wincategory",function(){$.ajax({url:"/ajax/wincategory",type:"POST",dataType:"HTML",success:function(n){$("body").append(n).css({overflow:"hidden"}),$(".owner-load").fadeIn(),$(".loads-all").fadeOut()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("click","#winload",function(){$.ajax({url:"/ajax/winloadimg",type:"POST",dataType:"HTML",success:function(n){$("body").append(n).css({overflow:"hidden"}),$(".owner-load").fadeIn(),$(".loads-all").fadeOut()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("click","#winvideo",function(){$.ajax({url:"/ajax/winvideo",type:"POST",dataType:"HTML",success:function(n){$("body").append(n).css({overflow:"hidden"}),$(".owner-load").fadeIn(),$(".loads-all").fadeOut()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("click","#wincomics",function(){$.ajax({url:"/ajax/wincomics",type:"POST",dataType:"HTML",success:function(n){$("body").append(n).css({overflow:"hidden"}),$(".owner-load").fadeIn(),$(".loads-all").fadeOut()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("click","#winmemes",function(){$.ajax({url:"/ajax/winmemes",type:"POST",dataType:"HTML",success:function(n){$("body").append(n).css({overflow:"hidden"}),$(".owner-load").fadeIn()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("change","#imgfilecategory",function(){$.each(this.files,function(n,e){sendFile(e,"/ajax/category","img")})}),$(document).on("change","#imgfilevideo",function(){$.each(this.files,function(n,e){sendFile(e,"/ajax/video","video")})}),$(document).on("change","#imgload",function(){$.each(this.files,function(n,e){sendFile(e,"/ajax/img","imgs")})}),$(document).on("change","#imgloadcom",function(){$.each(this.files,function(n,e){sendFile(e,"/ajax/comics","imgs")})}),$(document).on("change","#imgmemes",function(){$.each(this.files,function(n,e){sendFile(e,"/ajax/memes","memes")})}),$(document).on("click","#memes",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=$("#name").val(),e=$("#img").val();if(0==warning){$.ajax({url:"/ajax/imemes",type:"post",dataType:"json",data:{name:n,img:e},success:a,beforeSend:o});function a(n){1==n[0]?($(".response-form").html('<div class="done-img">Фотографии добавлены.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function o(){$(".loads-all").fadeIn()}}}),$(document).on("click","#comics",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#name",4,128),e=valid("#desc",4,1024),a=$("#img").val(),o=$("#pre").val();if(0==warning){$.ajax({url:"/ajax/icomics",type:"post",dataType:"json",data:{name:n,desc:e,img:a,pre:o},success:t,beforeSend:s});function t(n){1==n[0]?($(".response-form").html('<div class="done-img">Фотографии добавлены.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function s(){$(".loads-all").fadeIn()}}}),$(document).on("click","#photos",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#name",4,128),e=valid("#desc",4,1024),a=$("#img").val(),o=$("#pre").val();if(0==warning){$.ajax({url:"/ajax/iphotos",type:"post",dataType:"json",data:{name:n,desc:e,img:a,pre:o},success:t,beforeSend:s});function t(n){1==n[0]?($(".response-form").html('<div class="done-img">Фотографии добавлены.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function s(){$(".loads-all").fadeIn()}}}),$(document).on("click","#category",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#namec",4,128),e=valid("#url",4,128);if(0==warning){$.ajax({url:"/ajax/icategory",type:"post",dataType:"json",data:{namec:n,url:e},success:a,beforeSend:o});function a(n){1==n[0]?($(".response-form").html('<div class="done-img">Категория <b>"'+$("#namec").val()+'"</b> добавлена.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function o(){$(".loads-all").fadeIn()}}}),$(document).on("click","#stories",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#name",4,128),e=valid("#story",4,1e4);if(0==warning){$.ajax({url:"/ajax/ihistory",type:"post",dataType:"json",data:{name:n,story:e},success:a,beforeSend:o});function a(n){1==n[0]?($(".response-form").html('<div class="done-img">История добавлена.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function o(){$(".loads-all").fadeIn()}}}),$(document).on("click","#video",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#namec",4,128),e=valid("#url",4,128),a=$("#cats").val(),o=$("#desc").val(),t=$("#urlv").val();if(0==warning){$.ajax({url:"/ajax/ivideo",type:"post",dataType:"json",data:{namec:n,url:e,cats:a,desc:o,urlv:t},success:s,beforeSend:i});function s(n){1==n[0]?($(".response-form").html('<div class="done-img">Видео добавлено.</div>'),$(".response-form").fadeIn()):($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function i(){$(".loads-all").fadeIn()}}}),$(document).on("click",".win_fixed-exit",function(){$(".win__fixed").fadeOut(),$(".win__fixed").remove(),$("body").css({overflow:"auto"})}),$(".input_box textarea").on("input",function(){$(this).val().length>0?($(this).css({padding:"14px 8px 2px 8px"}),$(this).prev(".input_placeholder").css({transform:"scale(.83333) translateY(-12px)"})):($(this).prev(".input_placeholder").css({transform:"none"}),$(this).css({padding:"8px 8px 9px 8px"}))}),$(".input_box input").on("input",function(){$(this).val().length>0?($(this).css({padding:"14px 8px 2px 8px"}),$(this).prev(".input_placeholder").css({transform:"scale(.83333) translateY(-12px)"})):($(this).prev(".input_placeholder").css({transform:"none"}),$(this).css({padding:"8px 8px 9px 8px"}))});var email_pattern=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,login_pattern=/^[a-zA-Z][a-zA-Z0-9-_\.]{2,20}$/s,warning=0;$(document).on("input","#login",function(){$(".warning").remove(),valid("#login",5,32,login_pattern,"Некорректный формат логина")}),$(document).on("input","#password",function(){$(".warning").remove(),valid("#password",8,48)}),$(document).on("input","#code",function(){$(".warning").remove(),valid("#code",4,4)}),$(document).on("input","#name",function(){$(".warning").remove(),valid("#name",4,32)}),$(document).on("input","#surname",function(){$(".warning").remove(),valid("#surname",4,32)}),$(document).on("input","#email",function(){$(".warning").remove(),valid("#email",5,64,email_pattern,"Некорректный формат электронная почта")}),$(document).on("input","#password",function(){$(".warning").remove(),valid("#password",8,48)}),$(document).on("input","#password_confirm",function(){$(".warning").remove(),valid("#password_confirm",8,48)}),$(document).on("input","#url",function(){$(".warning").remove(),valid("#url",4,128)}),$(document).on("input","#namec",function(){$(".warning").remove(),valid("#namec",4,512)}),$(document).on("click","#auth",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#login",5,32,login_pattern,"Некорректный формат логина"),e=valid("#password",8,48);if(0==warning){$.ajax({url:"/ajax/auth",type:"post",dataType:"json",data:{login:n,password:e},success:a,beforeSend:o});function a(n){1==n[0]?document.location="/":($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function o(){$(".loads-all").fadeIn()}}}),$(document).on("click","#activation",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#code",4,4);if(0==warning){$.ajax({url:"/ajax/activation",type:"post",dataType:"json",data:{code:n},success:e,beforeSend:a});function e(n){1==n[0]?document.location="/":($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function a(){$(".loads-all").fadeIn()}}}),$(document).on("click","#likerecord",function(){var n=$(this).attr("id_record"),e=$(this).attr("id_group");$.ajax({url:"/ajax/likerecord",type:"post",dataType:"json",data:{id_record:n,id_group:e},success:function(n){$(".loads-all").fadeOut()},beforeSend:function(){$(".loads-all").fadeIn()}})}),$(document).on("click","#reg",function(){warning=0,$(".warning").remove(),$(".response-form").stop(!0,!0).fadeOut();var n=valid("#name",4,32),e=valid("#surname",4,32),a=valid("#email",5,64,email_pattern,"Некорректный формат электронная почта"),o=valid("#login",5,32,login_pattern,"Некорректный формат логина");if(valid("#password",8,48),valid("#password_confirm",8,48),$("#password").val()!==$("#password_confirm").val())warning++,$("#password").after("<div class='warning'>Пароли не совпадают</div>"),$("#password").css({border:"2px solid #E91E63"}),$("#password_confirm").after("<div class='warning'>Пароли не совпадают</div>"),$("#password_confirm").css({border:"2px solid #E91E63"});else{$("#password_confirm").css({border:"1px solid rgb(236, 232, 232)"}),$("#password").css({border:"1px solid rgb(236, 232, 232)"});var t=$("#password_confirm").val(),s=$("#password").val()}if(0==warning){$.ajax({url:"/ajax/reg",type:"post",dataType:"json",data:{name:n,surname:e,email:a,login:o,password:s,password_confirm:t},success:i,beforeSend:r});function i(n){1==n[0]?document.location="/reg/activation":($(".response-form").text(n[1]),$(".response-form").fadeIn()),$(".loads-all").fadeOut()}function r(){$(".loads-all").fadeIn()}}}),$(document).on("click",".bt-st",function(){$(this).parent().parent().find(".porn-category-bottom").hasClass("opens")?($(this).parent().parent().find(".porn-category-bottom").removeClass("opens"),$(this).text("Окрыть полностью")):($(this).parent().parent().find(".porn-category-bottom").addClass("opens"),$(this).text("Закрыть"));var n=$(this).parent().parent().parent().attr("id"),e=document.getElementById(n);$("html, body").animate({scrollTop:$(e).offset().top-62},1e3)}),$(".input_box textarea").on("input",function(){$(this).val().length>0?($(this).css({padding:"14px 8px 2px 8px"}),$(this).prev(".input_placeholder").css({transform:"scale(.83333) translateY(-12px)"})):($(this).prev(".input_placeholder").css({transform:"none"}),$(this).css({padding:"8px 8px 9px 8px"}))}),$(".input_box input").on("input",function(){$(this).val().length>0?($(this).css({padding:"14px 8px 2px 8px"}),$(this).prev(".input_placeholder").css({transform:"scale(.83333) translateY(-12px)"})):($(this).prev(".input_placeholder").css({transform:"none"}),$(this).css({padding:"8px 8px 9px 8px"}))});